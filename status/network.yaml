status:
  network:
    params:
      ifconfig_bin: ip addr show
      iwconfig_bin: iwconfig
      interface: eth0

    script: |
      def ifconfig
        `#{@ifconfig_bin} #{@interface} 2>&1`
      end

      def iwconfig
        `#{@iwconfig_bin} #{@interface} 2>/dev/null`
      end

    label: |
      ifconfig = self.ifconfig
      alive = ifconfig !~ /\A\S+ error/
      ip_addr = ifconfig[/inet (?:addr:)?([\d.]+)/, 1]

      if alive and ip_addr
        color = 'normal'
        #rx_bytes, tx_bytes = ifconfig.scan(/\((\d+(?:\.\d+)? \w+)\)/)
        #stats = ['@', ip_addr, "\u25BE", rx_bytes, "\u25B4", tx_bytes]
        #stats = ['@', ip_addr]
        stats = [ip_addr]
      else
        color = 'error'
        stats = [alive, ip_addr]
      end

      if self.iwconfig =~ /ESSID:"(.+?)"/
      #  stats.unshift "\u223F", $1
        stats.unshift "\u223F"
      end

      [color, @interface, stats]

    control:
      action:
        network_details: |
          dialog `#{@ifconfig_bin} #{@interface}`
          dialog `#{@iwconfig_bin} #{@interface}`

      mouse_action:
        left_click: network_details
